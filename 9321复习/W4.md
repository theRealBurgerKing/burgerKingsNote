# 数据服务


**模块化与接口化**：每个团队作为“服务”提供方，必须通过接口暴露其功能与数据；内部不能随意绕过接口。

“Web三个基本组成要素：

⭐ URL：统一资源定位符，负责“资源地址”。  
⭐ HTTP：用于在客户端／服务器之间传递请求与响应消息。  
⭐ HTML：用于格式化网页结构与内容。


![](assets/W4/file-20251126125806783.png)

**HTTP 请求（从浏览器至服务器）：**  
它由 **请求行（Request Line） + 报头（Header） + （可选）附加数据（additional data）** 构成。
请求行示例：
GET http://www.smh.com.au/index.html HTTP/1.1
在报头与附加数据部分之间必须有一个新行（CRLF）。

常见的请求方法（Request methods）：GET、POST、HEAD…

请求报头（Request header）可能包括：User-Agent、Referer、Authorization 等。

附加数据（body）：一般用于 POST 参数、数据块。


![](assets/W4/file-20251126130412869.png)


**HTTP Response（从服务器到浏览器）：**

- 由 **状态行（Status Line） + 报头（Header） + 主体（Body）** 构成。
    
- 状态行示例：`200 OK`、`404 Not Found` 等。
    
- 报头（Header）包括：`Content-Type`、`Content-Language`、`Content-Length`、`Cache-Control` 等。
    
- 主体（Body）：
    
    - 包含请求的资源数据。
        
    - 主体按特定 MIME 格式（例如 `text/HTML`）呈现。
        
    - MIME（Multipurpose Internet Mail Extension）：可以是纯文本、HTML、多媒体数据、应用程序格式例如 PDF、PowerPoint 等。



![](assets/W4/file-20251126130557882.png)


⭐ **早期网页架构**：2000 年代初很多站点结构简单、主要面向人类用户浏览器与 HTML 页面交互，整合方式多为“模拟浏览器点击／请求其它网站数据”。


服务化／API 化——站点开始暴露更明确的数据接口（如 XML、JSON 或专门的 API 域名），而不是仅通过网页 UI 获取信息。


一个 WebService 是一种“Consumer_Machine（消费者机器）→ Provider_Machine（提供者机器）”通过计算机网络协作的 schema（模式 / 架构）。


**Why Web Services（为什么要使用 Web Services）**

- 有很多情形下，需要处理的数据非常庞大，或频繁变化，不应该 (cannot / should not) 被硬编码 (hardcoded) 到应用 中。相反，这类数据应当从可靠的外部来源请求 (request) —— 例如，现在欧元兑美元的汇率是多少？
    
- 还有一类应用可能需要非常高的计算能力，这在移动设备上可能不可用。想象的问题例如：在两个地图坐标之间寻找最短 / 最快路线、为旅客选择最佳机票和路线。




**非人工交互界面**

- API不是为人类用户设计的界面，而是程序之间的通信接口
- 需要明确的合约规范（如IOU Alice Bob 100这样的例子）

**内部与外部使用**

- 现代公司既在内部使用API（私有API）
- 也对外提供API服务（公共API）



| 方面       | SOAP                    | REST                 |
| -------- | ----------------------- | -------------------- |
| **复杂度**  | 复杂，需要XML信封              | 简单，使用URL             |
| **格式**   | 严格的XML                  | 灵活（文本/HTML/XML/JSON） |
| **传输协议** | 多种（HTTP/HTTPS/FTP/SMTP） | 主要是HTTP/HTTPS        |
| **服务发现** | 有WSDL工具                 | 缺乏标准探索工具             |
| **开销**   | 较大（创建和解析XML）            | 较小                   |
| **灵活性**  | 低（格式固定）                 | 高（格式自由）              |
- **REST是架构风格**，不是协议
- **以资源为中心**的设计思想
- **使用标准HTTP方法**（GET、POST、PUT、DELETE等）
- **无状态通信**，每个请求独立
- **JSON格式**已成为REST API的事实标准
- **URI作为资源定位**的唯一标识



## 资源是 REST 的核心

**关键概念**：在 REST 中，一切始于资源，资源是基本单位。

## 什么是资源？

**定义**：任何可以被命名的信息都可以是资源，包括：

- 文档或图像
- 临时服务（如洛杉矶今日天气）
- 其他资源的集合
- 非虚拟对象（如人）
- 任何可能成为作者超文本引用目标的概念

## 资源的具体特征

一个资源必须满足：

- **唯一性** - 可被唯一标识
- **至少一种表现形式** - 可以用某种方式呈现
- **有属性** - 除了ID之外还有其他属性
- **有定义/模式** - 具有潜在的结构定义
- **有状态** - 可提供上下文（状态可以改变/更新）
- **可寻址** - 在可寻址的范围内可访问
- **有关系** - 可以是集合或关系






## 表现层状态转移（Representational State Transfer）

**核心概念**：REST 是一个 Web 资源网络（虚拟状态机），用户通过以下方式在应用中进行导航：

- **选择链接**：如 /students/M. Scott
- **执行操作**：如 GET 或 DELETE（状态转换）
- **结果**：进入下一个资源，代表应用的下一个状态
- **状态转移**：新状态被传递给用户使用

**示例流程**： 查询 M. Scott → 显示学生列表 → 选择 M. Scott → 显示详细信息 → Done 或 Cancel

---

## 资源的多重表现形式

**关键原则**：REST 不指定"标准数据格式"，而是**基于消费者的需求**提供不同格式。

**同一资源（M.Scott state）可以有多种表现形式**：

通过"业务逻辑"读取后，根据不同需求输出：

- **HTML** - 用于浏览器
- **XML** - 用于其他应用
- **JSON** - 用于移动应用
- **Image** - 图像格式
- **PDF** - PDF 文档
- **TEXT** - 纯文本



RESTful 服务/API 必须通过遵循设计指南/原则来满足架构约束。

## REST 的六大架构约束

1. **Client-Server（客户端-服务器）**
    - 客户端和服务器分离
2. **Uniform Interface（统一接口）**
    - 标准化的交互方式
3. **Statelessness（无状态性）**
    - 每个请求独立，服务器不保存客户端状态
4. **Caching（缓存）**
    - 响应可以被缓存以提高性能
5. **Layered System（分层系统）**
    - 可以有中间层（如代理、网关）
6. **Code on demand（按需代码）** - 可选
    - 服务器可以发送可执行代码给客户端